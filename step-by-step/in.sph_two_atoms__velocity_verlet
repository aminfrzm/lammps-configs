# move two atoms with DPD
units           si
atom_style         meso
atom_modify map array sort 0 0

region		box block 0 10 0 10 0 10 units box
create_box	1 box
mass            1 1

comm_modify    vel yes

create_atoms 1 single 5.0 5.0 5.0 units box
group           fst id 1
velocity        fst set 1 0 0 units box

variable        T equal 0.0
variable        cutoff equal 1.0
variable        gamma  equal 1.0
variable        adpd equal 0.0

set                group all meso_rho 1.0

pair_style      sph/taitwater/morris
pair_coeff	* * 1 1 1 ${cutoff}

fix	        1 all nve
neighbor	5.0 bin
neigh_modify    delay 0 every 1

timestep        0.1
run             0
variable dxpos equal x[1]
variable dvpos equal vx[1]
variable f1    equal fx[1]

print "f1(t_end) = ${f1}"
print "dx(t_end) = ${dxpos}"
print "dv(t_end) = ${dvpos}"
